{% extends "dashboard/base_dashboard.html" %}
{% block title %}Ø§Ù„Ù…Ø²ÙˆÙ‘Ø¯ÙˆÙ†{% endblock %}

{% block content %}
  <div class="flex items-start justify-between gap-4 mb-8">
    <div>
      <h1 class="text-3xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent">Ø§Ù„Ù…Ø²ÙˆÙ‘Ø¯ÙˆÙ†</h1>
      <p class="text-gray-500 mt-2">Ø§Ø³ØªØ¹Ø±Ø§Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ù…Ø²ÙˆÙ‘Ø¯ÙŠ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ù†ØµØ©</p>
    </div>
  </div>

  <form method="get" class="bg-white rounded-2xl shadow-lg border border-gray-100 p-6 mb-8">
    <div class="grid grid-cols-1 lg:grid-cols-6 gap-4">
      <div class="lg:col-span-2">
        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
          <span>ğŸ”</span>
          <span>Ø¨Ø­Ø«</span>
        </label>
        <input name="q" value="{{ q }}" placeholder="Ø§Ø³Ù… / Ø¬ÙˆØ§Ù„ / Ù†Ø¨Ø°Ø©"
               class="w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-400 focus:ring-2 focus:ring-purple-200 transition-all">
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
          <span>ğŸ“</span>
          <span>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</span>
        </label>
        <input name="city" value="{{ city }}" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ø±ÙŠØ§Ø¶"
               class="w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-400 focus:ring-2 focus:ring-purple-200 transition-all">
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
          <span>âœ“</span>
          <span>Ù…ÙˆØ«Ù‘Ù‚</span>
        </label>
        <select name="verified" class="w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-400 focus:ring-2 focus:ring-purple-200 transition-all">
          <option value="" {% if verified == "" %}selected{% endif %}>Ø§Ù„ÙƒÙ„</option>
          <option value="1" {% if verified == "1" %}selected{% endif %}>Ù…ÙˆØ«Ù‘Ù‚</option>
          <option value="0" {% if verified == "0" %}selected{% endif %}>ØºÙŠØ± Ù…ÙˆØ«Ù‘Ù‚</option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2">
          <span>âš¡</span>
          <span>ÙŠÙ‚Ø¨Ù„ Ø¹Ø§Ø¬Ù„</span>
        </label>
        <select name="urgent" class="w-full rounded-xl border-2 border-gray-200 px-4 py-3 focus:border-purple-400 focus:ring-2 focus:ring-purple-200 transition-all">
          <option value="" {% if urgent == "" %}selected{% endif %}>Ø§Ù„ÙƒÙ„</option>
          <option value="1" {% if urgent == "1" %}selected{% endif %}>Ù†Ø¹Ù…</option>
          <option value="0" {% if urgent == "0" %}selected{% endif %}>Ù„Ø§</option>
        </select>
      </div>

      <div class="lg:col-span-1 flex items-end gap-2">
        <button class="w-full px-6 py-3 rounded-xl bg-gradient-to-r from-purple-600 to-indigo-600 text-white hover:shadow-xl transition-all hover:scale-105 font-bold" type="submit">
          ØªØ·Ø¨ÙŠÙ‚
        </button>
      </div>
    </div>

    <div class="mt-4 pt-4 border-t border-gray-100">
      <a class="text-sm text-purple-600 hover:text-purple-700 font-semibold" href="{% url 'dashboard:providers_list' %}">ğŸ”„ ØªØµÙÙŠØ± Ø§Ù„ÙÙ„Ø§ØªØ±</a>
    </div>
  </form>

  <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
    <div class="px-6 py-5 bg-gradient-to-r from-gray-50 to-white border-b border-gray-100 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-emerald-500 to-teal-600 flex items-center justify-center text-white text-lg">ğŸ‘¥</div>
        <h2 class="font-bold text-lg text-gray-800">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø²ÙˆÙ‘Ø¯ÙŠÙ†</h2>
      </div>
      <div class="px-4 py-2 rounded-full bg-gradient-to-r from-purple-100 to-indigo-100">
        <span class="text-sm font-bold text-purple-700">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: {{ page_obj.paginator.count }}</span>
      </div>
    </div>

    <div class="overflow-x-auto">
      <table class="min-w-full text-sm">
        <thead class="bg-gradient-to-r from-gray-50 to-gray-100">
          <tr>
            <th class="text-right px-6 py-4 text-gray-600 font-bold">#</th>
            <th class="text-right px-6 py-4 text-gray-600 font-bold">Ø§Ù„Ø§Ø³Ù…</th>
            <th class="text-right px-6 py-4 text-gray-600 font-bold">Ø§Ù„Ø¬ÙˆØ§Ù„</th>
            <th class="text-right px-6 py-4 text-gray-600 font-bold">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</th>
            <th class="text-right px-6 py-4 text-gray-600 font-bold">Ù…ÙˆØ«Ù‘Ù‚</th>
            <th class="text-right px-6 py-4 text-gray-600 font-bold">Ø¹Ø§Ø¬Ù„</th>
            <th class="text-right px-6 py-4 text-gray-600 font-bold">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
            <th class="text-right px-6 py-4 text-gray-600 font-bold">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-100">
          {% for p in page_obj.object_list %}
            <tr class="hover:bg-gradient-to-r hover:from-emerald-50 hover:to-teal-50 transition-all">
              <td class="px-6 py-4">
                <span class="px-3 py-1 rounded-lg bg-gradient-to-r from-emerald-100 to-teal-100 text-emerald-700 font-bold text-xs">{{ p.id }}</span>
              </td>
              <td class="px-6 py-4">
                <div class="font-semibold text-gray-800">{{ p.display_name }}</div>
                <div class="text-xs text-gray-500 mt-1">{{ p.provider_type }}</div>
              </td>
              <td class="px-6 py-4 text-gray-600">{{ p.user.phone|default:"â€”" }}</td>
              <td class="px-6 py-4 text-gray-600">{{ p.city|default:"â€”" }}</td>
              <td class="px-6 py-4">
                {% if p.is_verified_blue or p.is_verified_green %}
                  <span class="inline-flex items-center px-3 py-1 rounded-full bg-gradient-to-r from-green-500 to-emerald-600 text-white text-xs font-bold">âœ“ Ù…ÙˆØ«Ù‘Ù‚</span>
                {% else %}
                  <span class="inline-flex items-center px-3 py-1 rounded-full bg-gray-100 text-gray-500 text-xs">ØºÙŠØ± Ù…ÙˆØ«Ù‘Ù‚</span>
                {% endif %}
              </td>
              <td class="px-6 py-4">
                {% if p.accepts_urgent %}
                  <span class="inline-flex items-center px-3 py-1 rounded-full bg-gradient-to-r from-amber-500 to-orange-600 text-white text-xs font-bold">âš¡ Ù†Ø¹Ù…</span>
                {% else %}
                  <span class="inline-flex items-center px-3 py-1 rounded-full bg-gray-100 text-gray-500 text-xs">Ù„Ø§</span>
                {% endif %}
              </td>
              <td class="px-6 py-4">
                <div class="flex items-center gap-1">
                  <span class="text-amber-500">â­</span>
                  <span class="font-semibold text-gray-800">{{ p.rating_avg }}</span>
                  <span class="text-gray-400 text-xs">({{ p.rating_count }})</span>
                </div>
              </td>
              <td class="px-6 py-4">
                <a class="px-4 py-2 rounded-lg bg-gradient-to-r from-purple-600 to-indigo-600 text-white hover:shadow-lg transition-all text-xs font-semibold" href="{% url 'dashboard:provider_detail' p.id %}">ØªÙØ§ØµÙŠÙ„ â†’</a>
              </td>
            </tr>
          {% empty %}
            <tr>
              <td class="px-6 py-12 text-gray-400 text-center" colspan="8">
                <div class="flex flex-col items-center gap-2">
                  <span class="text-4xl">ğŸ‘¥</span>
                  <span>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬.</span>
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="px-6 py-5 border-t border-gray-100 bg-gradient-to-r from-gray-50 to-white flex items-center justify-between">
      <div class="text-sm text-gray-600 font-medium">
        ØµÙØ­Ø© <span class="font-bold text-purple-600">{{ page_obj.number }}</span> Ù…Ù† <span class="font-bold text-purple-600">{{ page_obj.paginator.num_pages }}</span>
      </div>
      <div class="flex items-center gap-2">
        {% if page_obj.has_previous %}
          <a class="px-4 py-2 rounded-lg bg-gradient-to-r from-purple-600 to-indigo-600 text-white hover:shadow-lg transition-all font-semibold"
             href="?page={{ page_obj.previous_page_number }}&q={{ q }}&city={{ city }}&verified={{ verified }}&urgent={{ urgent }}">â† Ø§Ù„Ø³Ø§Ø¨Ù‚</a>
        {% endif %}
        {% if page_obj.has_next %}
          <a class="px-4 py-2 rounded-lg bg-gradient-to-r from-purple-600 to-indigo-600 text-white hover:shadow-lg transition-all font-semibold"
             href="?page={{ page_obj.next_page_number }}&q={{ q }}&city={{ city }}&verified={{ verified }}&urgent={{ urgent }}">Ø§Ù„ØªØ§Ù„ÙŠ â†’</a>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}
